\documentclass{article}
\usepackage{graphicx}
\usepackage{array,color}
\usepackage{fancyhdr}
\usepackage{extramarks}
\usepackage{extramarks}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{tikz}
\usepackage[plain]{algorithm}
\usepackage{algpseudocode}
\usepackage{indentfirst}
\usepackage{amssymb}
\usepackage{mdwtab}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{dcolumn}
\usepackage{pdfpages}
\usepackage{calrsfs}
\usepackage[round]{natbib}
\usepackage[nottoc,numbib]{tocbibind}
\usepackage{hyperref}
\usepackage{rotating}

\setlength{\parindent}{2em}
\usetikzlibrary{automata,positioning}

\usepackage[utf8]{inputenc}

\usepackage{listings}
\usepackage{xcolor}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
	backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\ttfamily\tiny,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2,
	rulecolor=\color{black}
}

\lstset{style=mystyle}

\renewcommand{\bibname}{References}

%
% Basic Document Settings
%

\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

\linespread{1.5}

\pagestyle{fancy}
\lhead{\hmwkTitle}
\rhead{\hmwkClass}
\chead{\firstxmark}
\lfoot{\lastxmark}
\cfoot{\thepage}

\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}

\setlength\parindent{0pt}

%
% Homework Details
%   - Title
%   - Class
%   - Section/Time
%   - Instructor
%   - Author
%

\newcommand{\hmwkTitle}{Paper Replication with R}
\newcommand{\hmwkClass}{MIS7420 Seminar in Management Information Systems}
\newcommand{\hmwkClasstwo}{MIS7420 \\ Seminar in Management Information Systems}
\newcommand{\hmwkClassInstructor}{Prof. Zhiqiang Zheng, Prof. Vijay Mookerjee }
\newcommand{\hmwkAuthorName}{\textbf{Author: Yihong Liu, }}
\newcommand{\hmwkID}{\textbf{NETID: YXL180111, }}
%
% Title Page
%

\DeclareMathAlphabet{\pazocal}{OMS}{zplm}{m}{n}
\newcommand{\La}{\mathcal{L}}
\newcommand{\Lb}{\pazocal{L}}

\title{
    \vspace{2in}
    \textmd{\textbf{\hmwkClasstwo:\ \\ \hmwkTitle}}\\
    \vspace{1in}\large{\textit{\hmwkClassInstructor}}
    \vspace{2in}
}

\author{\hmwkAuthorName
\  \\ \hmwkID
\vspace{0.3in}}

\date{}

\renewcommand{\part}[1]{\textbf{\large Part \Alph{partCounter}}\stepcounter{partCounter}\\}

\renewcommand*{\lstlistingname}{Code}
\renewcommand*{\lstlistlistingname}{List of Codes}
%\captionsetup[lstlisting]{margin=0cm,format=hang,font=small,format=plain,labelfont={bf,up},textfont={it}}
%\captionsetup[lstlistoflistings]{\lstname Code \arabic{lstlisting} :}

\begin{document}

\maketitle

\pagebreak

% Make Table of Contents
\tableofcontents
\pagebreak
% Make List of Figures
\listoffigures
\pagebreak
% Make List of Tables
\listoftables
\pagebreak
% Make List of Codes
\addcontentsline{toc}{section}{List of Codes}
\lstlistoflistings 
\pagebreak

\section{Data Cleaning Process}

\lstinputlisting[language=R, caption={Data Preprocess}, label={lst:dtaclean}, linerange={1-7, 10-63, 71-134, 138-143}]{../data_clean.R}

\pagebreak

\section{Paper Replication}
In this section, we provide our replication for this paper. Names for subsections correspond to the tables in the published paper.
\subsection{Table 1}
Table \ref{tab:table1} shows the summary statistics of top five vendors by sales volume.
\begin{table}[!h] \centering 
	\caption{Summary Statistics of Top Five Vendors by Sales Volume} 
	\label{tab:table1} 
	\resizebox{\columnwidth}{!}{
		\begin{tabular}{@{\extracolsep{5pt}} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} } 
			\\[-1.8ex]\hline 
			\hline 
			%\\[-1.8ex] 
			\multicolumn{1}{c}{\textbf{DomainName}} & \multicolumn{1}{c}{\textbf{TotalTransaction}} & \multicolumn{1}{c}{\textbf{TotalSales}} & \multicolumn{1}{c}{\textbf{TotalPagesViewed}} & \multicolumn{1}{c}{\textbf{PagesPerDollar}} & \multicolumn{1}{c}{\textbf{TotalDuration}} & \multicolumn{1}{c}{\textbf{MinsPerDollar}} \\ 
			\hline \\[-1.8ex] 
			\multicolumn{1}{c}{dell.com} & 1,620 & 483,703.300 & 66,953 & 0.138 & 57,225.660 & 0.118 \\ 
			\multicolumn{1}{c}{amazon.com} & 10,904 & 354,573.300 & 464,383 & 1.310 & 369,227.900 & 1.041 \\ 
			\multicolumn{1}{c}{staples.com} & 5,927 & 236,982.300 & 247,163 & 1.043 & 166,189.900 & 0.701 \\ 
			\multicolumn{1}{c}{walmart.com} & 1,977 & 156,606.100 & 80,397 & 0.513 & 68,434.890 & 0.437 \\ 
			\multicolumn{1}{c}{bestbuy.com} & 1,230 & 149,950.400 & 50,627 & 0.338 & 36,735.900 & 0.245 \\ 
			\bottomrule
			%\hline \\[-1.8ex] 
		\end{tabular} 
	}
\end{table}

Codes for generating Table \ref{tab:table1} are listed below.
\lstinputlisting[language=R, caption={Table 1 Generation}, label={lst:table1}, linerange={228-231}]{../data_clean.R}

\subsection{Table 2}
Table \ref{tab:table2} summarizes the frequency of referral channels for various online retailers.
\begin{table}[!h] \centering 
	\caption{Summary Statistics of Referring Domain Categories} 
	\label{tab:table2} 
	\resizebox{\columnwidth}{!}{
		\begin{tabular}{@{\extracolsep{5pt}} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} } 
			\\[-1.8ex]\hline 
			\hline 
			%\\[-1.8ex] 
			\multicolumn{1}{c}{\textbf{Domain Name}} & \multicolumn{1}{c}{\textbf{Total Transaction}} & \multicolumn{1}{c}{\textbf{Referred by SearchEngine}} & \multicolumn{1}{c}{\textbf{Direct to Website}} & \multicolumn{1}{c}{\textbf{Referred by Others}} \\ 
			\hline \\[-1.8ex]  
			\multicolumn{1}{c}{amazon.com} & 10,904 & 2,955(27.1\%) & 7,018(64.4\%) & 931(8.6\%) \\ 
			\multicolumn{1}{c}{bestbuy.com} & 1,230 & 258(21.0\%) & 901(73.3\%) & 71(5.8\%) \\ 
			\multicolumn{1}{c}{All Others} & 36,794 & 6,999(19.0\%) & 25,483(69.3\%) & 4,312(11.7\%) \\ 
			\multicolumn{1}{c}{All Transactions} & 48,928 & 10,212(20.9\%) & 33,402(68.3\%) & 5,314(10.9\%) \\
			\bottomrule
			%\hline \\[-1.8ex] 
		\end{tabular} 
	}
\end{table}

Codes for generating Table \ref{tab:table2} are listed below.
\lstinputlisting[language=R, caption={Table 2 Generation}, label={lst:table2}, linerange={233-239}]{../data_clean.R}

\subsection{Table 3}
Table \ref{tab:table3} reports the model-free average DID values for some outcome variables.
\begin{table}[!h]
	\centering
	\caption{Average Difference-in-Difference (DID) of the Outcome Variables}
	\label{tab:table3}
	\scalebox{0.8}{
		\begin{tabular}{@{}cccccc@{}}
			\\[-1.8ex]\hline 
			\hline 
			%\\[-1.8ex] 
			\textbf{Outcome Variable} &
			\textbf{Groups} &
			\begin{tabular}[c]{@{}c@{}}\textbf{After Store}\\ \textbf{Closure}\end{tabular} &
			\begin{tabular}[c]{@{}c@{}}\textbf{Before Store}\\ \textbf{Closure}\end{tabular} &
			\begin{tabular}[c]{@{}c@{}}\textbf{First Difference} \\ (se)\end{tabular} &
			\textbf{DID} \\ \midrule
			\multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Amazon\\ Sales\end{tabular}} &
			Control & 3.418 & 3.303 &
			\begin{tabular}[c]{@{}c@{}}0.115\\ (0.031)\end{tabular} &
			\multirow{2}{*}{-0.167} \\ 	& Treatment & 3.351 & 3.403 &
			\begin{tabular}[c]{@{}c@{}}-0.052\\ (0.212)\end{tabular} & \\
			\multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Amazon\\ PagesPerDollar\end{tabular}} &
			Control & 1.188 & 1.147 &
			\begin{tabular}[c]{@{}c@{}}0.041\\ (0.025)\end{tabular} &
			\multirow{2}{*}{0.257} \\ & Treatment & 1.363 & 1.065 &
			\begin{tabular}[c]{@{}c@{}}0.298\\ (0.153)\end{tabular} & \\
			\multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}Amazon\\ MinsPerDollar\end{tabular}} &
			Control & 1.016 & 0.975 &
			\begin{tabular}[c]{@{}c@{}}0.041\\ (0.025)\end{tabular} &
			\multirow{2}{*}{0.263} \\ & Treatment & 1.187 & 0.882 &
			\begin{tabular}[c]{@{}c@{}}0.304\\ (0.137)\end{tabular} &
			\\ \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}bestbuy.com\\ Sales\end{tabular}} &
			Control & 3.418 & 3.303 &
			\begin{tabular}[c]{@{}c@{}}0.354\\ (0.031)\end{tabular} &
			\multirow{2}{*}{0.623} \\ & Treatment & 3.351 & 3.403 &
			\begin{tabular}[c]{@{}c@{}}0.976\\ (0.212)\end{tabular} &
			\\ \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}bestbuy.com\\ PagesPerDollar\end{tabular}} &
			Control & 1.188 & 1.147 &
			\begin{tabular}[c]{@{}c@{}}-0.109\\ (0.025)\end{tabular} &
			\multirow{2}{*}{0.074} \\ & Treatment & 1.363 & 1.065 &
			\begin{tabular}[c]{@{}c@{}}-0.035\\ (0.153)\end{tabular} &
			\\ \multirow{2}{*}{\begin{tabular}[c]{@{}c@{}}bestbuy.com\\ MinsPerDollar\end{tabular}} &
			Control & 1.016 & 0.975 &
			\begin{tabular}[c]{@{}c@{}}-0.084\\ (0.025)\end{tabular} &
			\multirow{2}{*}{-0.012} \\ & Treatment & 1.187 & 0.882 &
			\begin{tabular}[c]{@{}c@{}}-0.096\\ (0.137)\end{tabular} &
			\\ \bottomrule
		\end{tabular}
	}
\end{table}

Codes for generating Table \ref{tab:table3} are listed below.
\lstinputlisting[language=R, caption={Table 3 Generation}, label={lst:table3}, linerange={15-15, 23-175}]{../table3.R}

\subsection{Table 4}
\begin{table}[!h] \centering 
	\caption{Results of the Sales Effect (All Product Categories)} 
	\label{tab:table4} 
	\resizebox{\columnwidth}{!}{
		\begin{tabular}{@{\extracolsep{1pt}}lD{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} } 
			\\[-1.8ex]\hline 
			\hline \\[-1.8ex] 
			% & \multicolumn{4}{c}{\textit{Dependent variable:}} \\ 
			% \cline{2-5} 
			% \\[-1.8ex] 
			& \multicolumn{4}{c}{log(TotalMonthlySales + 1)} \\ 
			& \multicolumn{1}{c}{Amazon-0 Mile} & \multicolumn{1}{c}{Amazon-5 Miles} & \multicolumn{1}{c}{BestBuy-0 Mile} & \multicolumn{1}{c}{BestBuy-5 Miles} \\ 
			\\[-1.8ex] & \multicolumn{1}{c}{(1)} & \multicolumn{1}{c}{(2)} & \multicolumn{1}{c}{(3)} & \multicolumn{1}{c}{(4)}\\ 
			\hline \\[-1.8ex] 
			$\beta_1$ & 0.138 & -0.202 & 0.090 & -1.002 \\ 
			& (0.524) & (0.198) & (1.171) & (0.896) \\ 
			$\beta_2$ & 0.109 & 0.096 &  & 1.116 \\ 
			& (0.668) & (0.245) &  & (1.224) \\ 
			\hline \\[-1.8ex] 
			Observations & \multicolumn{1}{c}{5,126} & \multicolumn{1}{c}{5,781} & \multicolumn{1}{c}{729} & \multicolumn{1}{c}{837} \\ 
			R$^{2}$ & \multicolumn{1}{c}{0.0002} & \multicolumn{1}{c}{0.001} & \multicolumn{1}{c}{0.0001} & \multicolumn{1}{c}{0.012} \\ 
			Adjusted R$^{2}$ & \multicolumn{1}{c}{-1.279} & \multicolumn{1}{c}{-1.199} & \multicolumn{1}{c}{-6.744} & \multicolumn{1}{c}{-6.512} \\ 
			F Statistic & \multicolumn{1}{c}{0.204 (df = 2; 2248)} & \multicolumn{1}{c}{0.672 (df = 2; 2627)} & \multicolumn{1}{c}{0.006 (df = 1; 94)} & \multicolumn{1}{c}{0.647 (df = 2; 110)} \\ 
			\hline 
			\hline \\[-1.8ex] 
			\textit{Note: Standard errors are in parentheses}  & \multicolumn{4}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
		\end{tabular} 
	}
\end{table}

Codes for generating Table \ref{tab:table4} are listed below.
\lstinputlisting[language=R, caption={Table 4 Generation}, label={lst:table4}, linerange={145-152, 248-252}]{../data_clean.R}

\subsection{Table 5}

\begin{table}[!htbp] \centering 
	\caption{Results of the Search Effect (All Product Categories)} 
	\label{tab:table5} 
	\resizebox{\columnwidth}{!}{
		\begin{tabular}{@{\extracolsep{1pt}}lD{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} D{.}{.}{-3} } 
			\\[-1.8ex]\hline 
			\hline \\[-1.8ex] 
			%& \multicolumn{8}{c}{\textit{Dependent variable:}} \\ 
			%\cline{2-9} 
			%\\[-1.8ex] 
			& \multicolumn{4}{c}{log(PagesPerDollar + 1)} & \multicolumn{4}{c}{log(MinsPerDollar + 1)} \\ 
			& \multicolumn{1}{c}{Amazon-0 Mile} & \multicolumn{1}{c}{Amazon-5 Miles} & \multicolumn{1}{c}{BestBuy-0 Mile} & \multicolumn{1}{c}{BestBuy-5 Miles} & \multicolumn{1}{c}{Amazon-0 Mile} & \multicolumn{1}{c}{Amazon-5 Miles} & \multicolumn{1}{c}{BestBuy-0 Mile} & \multicolumn{1}{c}{BestBuy-5 Miles} \\ 
			\\[-1.8ex] & \multicolumn{1}{c}{(1)} & \multicolumn{1}{c}{(2)} & \multicolumn{1}{c}{(3)} & \multicolumn{1}{c}{(4)} & \multicolumn{1}{c}{(5)} & \multicolumn{1}{c}{(6)} & \multicolumn{1}{c}{(7)} & \multicolumn{1}{c}{(8)}\\ 
			\hline \\[-1.8ex] 
			$\beta_1$ & -0.078 & 0.072 & 0.476 & 0.373 & 0.149 & 0.063 & 0.127 & 0.513 \\ 
			& (0.411) & (0.156) & (0.680) & (0.511) & (0.400) & (0.152) & (0.544) & (0.425) \\ 
			$\beta_2$ & -0.263 & -0.056 &  & -0.028 & -0.387 & -0.047 &  & -0.309 \\ 
			& (0.524) & (0.193) &  & (0.697) & (0.510) & (0.188) &  & (0.580) \\ 
			\hline \\[-1.8ex] 
			Observations & \multicolumn{1}{c}{5,126} & \multicolumn{1}{c}{5,781} & \multicolumn{1}{c}{729} & \multicolumn{1}{c}{837} & \multicolumn{1}{c}{5,126} & \multicolumn{1}{c}{5,781} & \multicolumn{1}{c}{729} & \multicolumn{1}{c}{837} \\ 
			R$^{2}$ & \multicolumn{1}{c}{0.0005} & \multicolumn{1}{c}{0.0001} & \multicolumn{1}{c}{0.005} & \multicolumn{1}{c}{0.008} & \multicolumn{1}{c}{0.0003} & \multicolumn{1}{c}{0.0001} & \multicolumn{1}{c}{0.001} & \multicolumn{1}{c}{0.014} \\ 
			Adjusted R$^{2}$ & \multicolumn{1}{c}{-1.279} & \multicolumn{1}{c}{-1.200} & \multicolumn{1}{c}{-6.705} & \multicolumn{1}{c}{-6.537} & \multicolumn{1}{c}{-1.279} & \multicolumn{1}{c}{-1.200} & \multicolumn{1}{c}{-6.740} & \multicolumn{1}{c}{-6.490} \\ 
			F Statistic & \multicolumn{1}{c}{0.552 (df = 2; 2248)} & \multicolumn{1}{c}{0.109 (df = 2; 2627)} & \multicolumn{1}{c}{0.490 (df = 1; 94)} & \multicolumn{1}{c}{0.458 (df = 2; 110)} & \multicolumn{1}{c}{0.347 (df = 2; 2248)} & \multicolumn{1}{c}{0.089 (df = 2; 2627)} & \multicolumn{1}{c}{0.055 (df = 1; 94)} & \multicolumn{1}{c}{0.805 (df = 2; 110)} \\ 
			\hline 
			\hline \\[-1.8ex] 
			\textit{Note:}  & \multicolumn{8}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
		\end{tabular} 
	}
\end{table}

Codes for generating Table \ref{tab:table5} are listed below.
\lstinputlisting[language=R, caption={Table 5 Generation}, label={lst:table5}, linerange={154-161, 278-283, 299-303}]{../data_clean.R}

\subsection{Table 6}

\subsection{Table 7}

\subsection{Table 8}

\subsection{Table 9}

\subsection{Table 10}

\subsection{Table 11}

\subsection{Table 12}

\subsection{Table 13}

\subsection{Table 14}

\subsection{Table C1}
% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
% \usepackage{multirow}
\begin{table}[!htb]
	\centering
	\caption{Change in Demographics after Circuit City Store Closure}
	\label{tab:tabc1}
	\resizebox{\columnwidth}{!}{
	\begin{tabular}{@{}cccccccccc@{}}
		%\toprule
		\\[-1.8ex]\hline 
		\hline 
		\multirow{2}{*}{\textbf{Group}} &
		\multicolumn{3}{c}{\textbf{Before Store Closure}} &
		\multicolumn{3}{c}{\textbf{After Store Closure}} &
		\multicolumn{3}{c}{\textbf{\begin{tabular}[c]{@{}c@{}}First Difference of Mean\\ (p-value)\end{tabular}}} \\ \cmidrule(l){2-10} 
		&
		\textbf{\begin{tabular}[c]{@{}c@{}}Mean\\ Age\end{tabular}} &
		\textbf{\begin{tabular}[c]{@{}c@{}}Mean\\ Income\end{tabular}} &
		\textbf{\begin{tabular}[c]{@{}c@{}}Mean\\ Education\end{tabular}} &
		\textbf{\begin{tabular}[c]{@{}c@{}}Mean\\ Age\end{tabular}} &
		\textbf{\begin{tabular}[c]{@{}c@{}}Mean\\ Income\end{tabular}} &
		\textbf{\begin{tabular}[c]{@{}c@{}}Mean\\ Education\end{tabular}} &
		\textbf{\begin{tabular}[c]{@{}c@{}}Mean\\ Age\end{tabular}} &
		\textbf{\begin{tabular}[c]{@{}c@{}}Mean\\ Income\end{tabular}} &
		\textbf{\begin{tabular}[c]{@{}c@{}}Mean\\ Education\end{tabular}} \\ \midrule
		\textbf{Control} &
		7.048 &
		4.479 &
		97.957 &
		6.937 &
		4.498 &
		97.999 &
		\begin{tabular}[c]{@{}c@{}}-0.111\\ ($<$0.0001)\end{tabular} &
		\begin{tabular}[c]{@{}c@{}}0.019\\ (0.300)\end{tabular} &
		\begin{tabular}[c]{@{}c@{}}0.042\\ (0.639)\end{tabular} \\
		\textbf{Treated} &
		7.68 &
		4.971 &
		98.632 &
		6.645 &
		4.739 &
		96.843 &
		\begin{tabular}[c]{@{}c@{}}-1.035\\ ($<$0.0001)\end{tabular} &
		\begin{tabular}[c]{@{}c@{}}-0.232\\ (0.029)\end{tabular} &
		\begin{tabular}[c]{@{}c@{}}-1.789\\ (0.004)\end{tabular} \\ \bottomrule
	\end{tabular}}
\end{table}

\subsection{Table D1-D4}

\subsection{Table E1-E2}

\subsection{Table G1-G3}

\section{Advanced Method}

\subsection{Synthetic Control Method}

\subsection{Generalized Synthetic Control Method}

\subsection{Heckit Approach}

\subsection{PSM and LA-PSM}

\subsection{Measurement Error Bias Correction}

\pagebreak
% \section{Reference}
\setcitestyle{numbers} % set the citation style to ``numbers''.
\bibliographystyle{plainnat}
\bibliography{bobo}
% \bibliographystyle{plainnat}

\end{document}
